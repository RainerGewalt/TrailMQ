tls:
  server_cert: ./certs/server_cert.pem
  server_key: ./certs/server_key.pem
  ca_cert: ./certs/ca_cert.pem
  whitelist:
    - 0.0.0.0/0 # IPv4: all
    - ::/0      # IPv6: all (or minimal just ::1/128)
  enable_ocsp: true
  ocsp_fail_close: false
  rate_limit: 10
  allowed_ciphers: []
  client_auth_enabled: false
  min_version: "1.3"
  allow_tls12_fallback: false

mqtt_port: 8883
mqtt_use_tls: true
rest_port: 8443
rest_use_tls: false

# WebSocket-Konfiguration
mqtt_ws_port: 9001
mqtt_ws_use_tls: false
mqtt_wss_port: 9443
mqtt_ws_path: "/mqtt"
mqtt_ws_allowed_origins:
  - "http://localhost:8888"
  - "http://[::1]:8888"
  - "http://nginx"
  - "http://192.168.189.29:8888"
  - "http://localhost"
  - "http://localhost:80"    # ‚Üê explicit port 80
mqtt_ws_max_connections: 1000
mqtt_ws_ping_interval: 60
mqtt_ws_read_limit: 1048576  # 1MB
mqtt_ws_write_limit: 1048576 # 1MB

queue_size: 100
audit_max_size: 500
db_path: ./data/mqtrail.db

jwtsecret_file: ./secrets/jwtsecret.txt

roles:
  - id: 1
    name: admin
    description: "Administrator role"
    permissions: ["*"]
  - id: 2
    name: publisher
    description: "Can publish messages"
    permissions: ["publish:*"]
  - id: 3
    name: viewer
    description: "Read-only user"
    permissions: ["subscribe:*"]
  - id: 4
    name: devops
    description: "Deployment / monitoring tasks"
    permissions: ["publish:metrics", "subscribe:alerts"]

users:
  - username: testuser
    password: PubUser!2025X
    roles: [publisher]
    email: ""
    enabled: true
    managed_by_config: true
    
  - username: testadmin
    password: PubAdmin!2025X
    roles: [admin]
    email: ""
    enabled: true
    managed_by_config: true

  - username: fileuser
    password_file: ./secrets/fileuser.pwd
    roles: [viewer, publisher]
    email: "fileuser@example.local"
    enabled: true
    managed_by_config: true

  - username: hashuser
    password_hash: "$argon2id$v=19$m=65536,t=3,p=2$c29tZXNhbHQ$2idn4xkn6Uy4fVhQ4mAZnR9pQ3hUbbKhx8cczX0lML8"
    roles: [viewer]
    email: "hashuser@example.local"
    enabled: true
    managed_by_config: true

  - username: devopsadmin
    password: F9!xGlaCedar-2025
    roles: [admin, devops]
    email: "devops@example.local"
    enabled: true
    managed_by_config: false

export_dir: ./data/export

queue_advanced:
  dead_letter_enabled: true
  dead_letter_topic: dlq/error
  message_ttl_seconds: 3600
  batch_size: 100
  batch_timeout: 2
  max_batch_size_bytes: 1048576
  enable_priority_queue: true

audit_advanced:
  max_size: 10000
  auto_cleanup: true
  auto_export: false
  export_format: ""
  export_dir: ./data/audit_backup

dynamic_features:
  cert_rotation_enabled: true
  auto_topic_creation: true
  inactivity_threshold: "10m"
  topic_retention_period: "24h"

endpoint_rate_limits: []
anonymous_access: false
default_role: ""

cors:
  allowed_origins:
    - http://nginx
    - http://localhost:8888
    - http://localhost:5173  # Vite dev server
    - http://localhost:3000  # Alternative dev port
    - http://192.168.189.29:8888
    - http://localhost
  allowed_methods:
    - GET
    - POST
    - PUT
    - DELETE
    - OPTIONS
    - PATCH
  allowed_headers:
    - Content-Type
    - Authorization
    - X-Requested-With
  exposed_headers:
    - Content-Disposition
  allow_credentials: true

authsyncmode: "merge"
log_level: "info"
log_path: "logs"

audit_archive_path: "./audit-archive"
audit_retention_days: 90
